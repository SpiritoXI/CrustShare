# 更新日志

所有项目的显著变更都将记录在此文件中。

格式基于 [Keep a Changelog](https://keepachangelog.com/zh-CN/1.0.0/)，
并且本项目遵循 [语义化版本](https://semver.org/lang/zh-CN/)。

## [3.1.0] - 2026-02-03

### 新增

- Redis 连接失败降级处理机制
  - 自动重试机制（默认3次）
  - 指数退避策略
  - 内存缓存降级方案
  - 支持 LPUSH、LRANGE、LREM、HSET、HGET、HGETALL、HDEL、HLEN、LLEN 命令
- Crust 上传重试机制
  - 网络错误自动重试
  - 服务器错误自动重试
  - 超时自动重试
  - 指数退避延迟策略（最大10秒）
- localStorage 存储限制处理
  - 网关缓存数量限制（最多50个）
  - 健康度历史记录限制（最多30个）
  - 缓存大小检查（网关缓存4MB，健康度历史2MB）
  - 存储失败自动清理机制
- 文件大小格式化边界处理
  - 0字节特殊处理
  - 超大文件（>PB）处理
  - 扩展 size units 到 PB

### 修复

- 修复 CONFIG.API_GET_TOKEN 引用错误
  - 更新 API 引用方式
  - 添加 CRUST 配置到 CONFIG 对象确保向后兼容
- 修复文件大小格式化边界情况
  - 添加非数字、NaN、负数等异常情况处理

### 改进

- 优化错误处理机制
- 增强系统容错性和稳定性
- 改进边界场景处理

## [3.0.0] - 2026-01-30

### 新增

- 全新设计的用户界面
  - 基于 shadcn/ui 的现代化组件
  - 响应式设计，支持移动端
  - 暗黑模式支持
- 文件管理功能
  - 文件上传（拖拽、点击）
  - 文件列表展示（列表/网格视图）
  - 文件搜索和排序
  - 批量操作（移动、复制、删除）
  - 文件重命名
- 文件夹管理
  - 创建文件夹
  - 重命名文件夹
  - 删除文件夹
  - 文件夹树形导航
- 智能网关系统
  - 自动测试网关可用性
  - 延迟检测
  - 健康度评分
  - 智能选择最优网关
  - 自定义网关添加
- 文件分享功能
  - 生成分享链接
  - 密码保护
  - 过期时间设置
  - 多网关下载
- 多媒体支持
  - 图片预览
  - 视频在线播放
  - 音频在线播放
- CID 导入功能
  - 支持导入已有 IPFS CID
  - 自动获取 CID 信息

### 技术栈

- Next.js 14
- React 18
- TypeScript 5
- Tailwind CSS 3
- Zustand 4
- Framer Motion
- TanStack Query 5

## [2.0.0] - 2025-12-16

### 新增

- 基础文件上传功能
- IPFS 网关支持
- 简单的文件列表
- 基础分享功能

## [1.0.0] - 2025-12-05

### 新增

- 项目初始化
- 基础架构搭建
- 概念验证版本

---

## 版本说明

### 版本号格式

版本号格式：主版本号.次版本号.修订号（MAJOR.MINOR.PATCH）

- **主版本号**：做了不兼容的 API 修改
- **次版本号**：做了向下兼容的功能性新增
- **修订号**：做了向下兼容的问题修正

### 变更类型说明

- **新增（Added）**：新添加的功能
- **修复（Fixed）**：修复的问题
- **变更（Changed）**：对现有功能的变更
- **弃用（Deprecated）**：即将被移除的功能
- **移除（Removed）**：已移除的功能
- **安全（Security）**：安全相关的修复

---

## 如何更新

### 从旧版本升级

1. 备份现有数据和配置
2. 查看对应版本的升级指南
3. 更新代码到最新版本
4. 更新环境变量（如有变更）
5. 重新部署

### 检查当前版本

```bash
# 查看 package.json 中的版本号
cat package.json | grep version
```

---

## 贡献

欢迎提交 Issue 和 Pull Request 来帮助改进项目！

查看 [CONTRIBUTING.md](./CONTRIBUTING.md) 了解如何参与贡献。
